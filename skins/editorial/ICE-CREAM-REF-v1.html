<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Ice Cream Quantity Calculator — How Much You Will Need</title>
  <meta name="description" content="Enter guests and settings. We estimate how many quarts of ice cream you will need (planning estimate).">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta name="dm-category" content="dessert">
  <meta name="dm-food" content="Ice Cream">
  <meta name="dm-portion-spec" content="v1.8">
</head>
<body class="dm-editorial">
<main id="calculator" class="dm-grid">

  <!-- Header (not a step) -->
  <section class="card" aria-label="Header">
    <h1>Ice Cream Quantity Calculator — How Much You Will Need</h1>
    <p class="lede">Enter guests and settings (or tap a quick preset). We will estimate how many quarts of ice cream you will need (planning estimate).</p>
  </section>

  <!-- STEP 1 — Guests -->
  <section class="card" aria-label="STEP 1">
    <div class="step-label">STEP 1 • Guests</div>
    <div class="row" aria-label="Guests fields">
      <div><label for="inAdults">Adults</label><input id="inAdults" type="number" inputmode="numeric" min="0" step="1" value="5"></div>
      <div><label for="inTeens">Teens</label><input id="inTeens" type="number" inputmode="numeric" min="0" step="1" value="0"></div>
      <div><label for="inChildren">Children</label><input id="inChildren" type="number" inputmode="numeric" min="0" step="1" value="0"></div>
    </div>
    <div class="inline" style="margin-top:8px">
      <span class="muted">Quick presets:</span>
      <button class="preset" data-people="10" type="button">10</button>
      <button class="preset" data-people="25" type="button">25</button>
      <button class="preset" data-people="50" type="button">50</button>
      <button class="preset" data-people="100" type="button">100</button>
      <span class="muted">Presets set all as adults. Tweak Teens and Children if needed.</span>
      <div style="flex:1"></div>
      <button id="btnReset" type="button" class="preset">Reset</button>
    </div>
  </section>

  <!-- STEP 2 — Event length (hidden for Desserts by category; factor 1.00). No UI -->

  <!-- STEP 3 — Appetite -->
  <section class="card" aria-label="STEP 3">
    <div class="step-label">STEP 3 • Appetite</div>
    <div class="row-2">
      <div>
        <label for="inAppetite">How generous would you like the portions to be?</label>
        <select id="inAppetite">
          <option value="0.90">Light (0.90) — Allows for lighter portions.</option>
          <option value="1.00" selected>Moderate (1.00) — Allows for standard portions.</option>
          <option value="1.15">Generous (1.15) — Allows for heartier portions.</option>
        </select>
      </div>
      <div>
        <label for="inScoop">Scoop size</label>
        <select id="inScoop">
          <option value="0.40">Small scoop — 0.4 cup</option>
          <option value="0.50" selected>Standard scoop — 0.5 cup</option>
          <option value="0.60">Large scoop — 0.6 cup</option>
          <option value="1.00">Double scoop — 1.0 cup</option>
        </select>
        <div class="muted">We convert scoops to cups, then to pints, quarts, and gallons.</div>
      </div>
    </div>
  </section>

  <!-- STEP 4 — Role / Meal-Share -->
  <section class="card" aria-label="STEP 4">
    <div class="step-label">STEP 4 • Role or Meal-Share</div>
    <label for="inRole">Will this be the only dessert you are serving?</label>
    <select id="inRole">
      <option value="1.00">This is the only dessert being served. — Allows for full slices or servings — usually one per person. (1.00)</option>
      <option value="0.60">There will be two or more desserts offered at the meal. — Allows for smaller servings — 1/2 slice or 1 small piece per person. (0.60)</option>
      <option value="0.45">I only want to serve a small portion of ice cream. — Allows for a few bites — 1/3 slice or 1 mini dessert per person. (0.45)</option>
      <option value="0.35">This is just a small bite or mini sweet to finish the meal. — Allows for a single bite-size piece per person. (0.35)</option>
    </select>
    <div class="muted" style="margin-top:6px">Multipliers: 1.00, 0.60, 0.45, 0.35.</div>
  </section>

  <!-- STEP 5 — Food-specific inputs -->
  <section class="card" aria-label="STEP 5">
    <div class="step-label">STEP 5 • Ice cream specifics</div>
    <div class="row-2">
      <div>
        <label for="inServingStyle">Serving style</label>
        <select id="inServingStyle">
          <option value="mixed" selected>Mixed — cones and bowls</option>
          <option value="cones">Mostly cones</option>
          <option value="bowls">Mostly bowls</option>
        </select>
        <div class="muted">Serving style sets the default split. You can still edit the percent below.</div>
      </div>
      <div>
        <label for="inToppings">Toppings bar</label>
        <select id="inToppings">
          <option value="no" selected>No</option>
          <option value="yes">Yes (tends higher)</option>
        </select>
      </div>
    </div>
    <div class="row">
      <div>
        <label for="inConePct">Percent served in cones</label>
        <input id="inConePct" type="number" inputmode="numeric" min="0" max="100" step="1" value="50">
      </div>
      <div>
        <label for="inConePackSize">Cones per pack</label>
        <input id="inConePackSize" type="number" inputmode="numeric" min="1" step="1" value="12">
      </div>
      <div>
        <label for="inConePackPrice">Price per cone pack</label>
        <input id="inConePackPrice" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 3.49">
      </div>
    </div>
  </section>

  <!-- Results -->
  <section class="card results" aria-label="Results" aria-live="polite">
    <h2>Results</h2>

    <div class="kv"><span>Total guests counted</span><b id="outGuests">—</b></div>

    <div class="kv"><span>Buy</span><b id="outBuy">—</b></div>
    <div class="kv"><span>Also shown</span><b id="outAltUnits">—</b></div>

    <div class="chips" id="outChips" aria-label="Summary pills"></div>

    <p class="muted" id="outHybrid">Totals reflect a small built-in planning allowance.</p>
  </section>

  <!-- Pricing (optional) -->
  <section class="card pricing" aria-label="Pricing">
    <h2>Pricing (optional)</h2>
    <div class="row-2">
      <div class="card" style="margin:0">
        <h3 style="margin:0 0 8px">Ice cream containers</h3>
        <div class="row">
          <div>
            <label for="inUnitSize">Container size</label>
            <select id="inUnitSize">
              <option value="2">Pint — 2 cups</option>
              <option value="4" selected>Quart — 4 cups</option>
              <option value="8">Half gallon — 8 cups</option>
              <option value="16">Gallon — 16 cups</option>
            </select>
          </div>
          <div>
            <label for="inUnitPrice">Price per container</label>
            <input id="inUnitPrice" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 5.99">
          </div>
        </div>
      </div>

      <div class="card" style="margin:0">
        <h3 style="margin:0 0 8px">Serving containers (packs)</h3>
        <div class="row">
          <div>
            <label for="inBowlPackSize">Bowls per pack</label>
            <input id="inBowlPackSize" type="number" inputmode="numeric" min="1" step="1" value="50">
          </div>
          <div>
            <label for="inBowlPackPrice">Price per bowl pack</label>
            <input id="inBowlPackPrice" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 2.99">
          </div>
        </div>
        <div class="muted">We round people to whole pieces and then to whole packs.</div>
      </div>
    </div>

    <div class="row-2" style="margin-top:8px"></div>

    <div class="row">
      <div>
        <label for="inTaxPct">Sales tax (percent)</label>
        <input id="inTaxPct" type="number" inputmode="decimal" min="0" step="0.1" placeholder="e.g., 7.5">
      </div>
      <div>
        <label for="inFees">Extra fees (US dollars)</label>
        <input id="inFees" type="number" inputmode="decimal" min="0" step="0.01" placeholder="e.g., 5.00">
      </div>
    </div>

    <div class="row-2" style="margin-top:8px">
      <div class="kv"><span>Containers subtotal</span><b id="outSubContainers">$—</b></div>
      <div class="kv"><span>Serving packs subtotal</span><b id="outSubPacks">$—</b></div>
      <div class="kv"><span>Combined cost (subtotal)</span><b id="outSubtotal">$—</b></div>
      <div class="kv"><span>Tax and fees</span><b id="outAdds">$—</b></div>
      <div class="kv"><span>Estimated total</span><b id="outTotal">$—</b></div>
      <div class="kv"><span>Cost per person</span><b id="outPPP">$—</b></div>
    </div>
  </section>

  <!-- Finder -->
  <section class="card finder" aria-label="Finder">
    <div class="inline">
      <a class="preset" href="#" onclick="try{window.open('https://www.google.com/maps/search/ice+cream+near+me','_blank');}catch(e){location.href='https://www.google.com/maps/search/ice+cream+near+me';}return false;">Find ice cream near me</a>
      <a class="pill" href="#" onclick="try{window.open('https://www.google.com/maps/search/ice+cream+shop','_blank');}catch(e){location.href='https://www.google.com/maps/search/ice+cream+shop';}return false;">Ice cream shops</a>
      <a class="pill" href="#" onclick="try{window.open('https://www.google.com/maps/search/grocery+store','_blank');}catch(e){location.href='https://www.google.com/maps/search/grocery+store';}return false;">Grocery stores</a>
    </div>
  </section>

  <!-- Footer -->
  <section class="card" aria-label="Footer">
    <p class="muted" style="margin:0">
      This tool provides general portion and cost estimates for planning only. Results depend on the information you enter and typical averages. DinnerMath is not responsible for decisions, purchases, or outcomes based on these estimates. (c) 2025 DinnerMath. All rights reserved. Use for planning only.
    </p>
  </section>

</main>


<!-- Calculator config and hooks (Ice Cream) -->
<script>
  window.CALC_CONFIG = {
    // Select-all inputs (project lock)
    selectAllIds: [
      "inAdults","inTeens","inChildren",
      "inConePct","inConePackSize","inConePackPrice",
      "inBowlPackSize","inBowlPackPrice","inUnitPrice",
      "inTaxPct","inFees"
    ],

    // Chips and common selectors
    outChipsId: "outChips",
    inRoleId: "inRole",
    inAppetiteId: "inAppetite",
    foodChipIds: [
      { id: "inScoop", label: "Scoop" },
      { id: "inServingStyle", label: "Style" },
      { id: "inToppings", label: "Toppings" }
      // conePct intentionally not chipped
    ],

    // Pricing section selector
    pricingSectionSelector: "section.pricing",

    // Inclusion matrix and id map (Ice Cream)
    inclusion: {
      scoop:        { ui:true,  math:true,  chips:true },
      servingStyle: { ui:true,  math:false, chips:true },
      toppings:     { ui:true,  math:true,  chips:true },
      conePct:      { ui:true,  math:true,  chips:false }
    },
    idMap: {
      scoop: "inScoop",
      servingStyle: "inServingStyle",
      toppings: "inToppings",
      conePct: "inConePct"
    },

    // Calculator-specific helpers
    init: function(){
      // Presets set all as adults
      document.querySelectorAll(".preset[data-people]").forEach(btn=>{
        btn.addEventListener("click",()=>{
          var n = parseInt(btn.getAttribute("data-people"),10)||0;
          document.getElementById("inAdults").value = String(n);
          document.getElementById("inTeens").value = "0";
          document.getElementById("inChildren").value = "0";
          // Engine will recompute via listeners
        });
      });

      // Reset button
      this.resetButtonId = "btnReset";
      this.onReset = function(){
        document.getElementById("inAdults").value="5";
        document.getElementById("inTeens").value="0";
        document.getElementById("inChildren").value="0";
        document.getElementById("inAppetite").value="1.00";
        document.getElementById("inScoop").value="0.50";
        document.getElementById("inRole").value="1.00";
        document.getElementById("inServingStyle").value="mixed";
        document.getElementById("inToppings").value="no";
        document.getElementById("inConePct").value="50";
        document.getElementById("inConePackSize").value="12";
        document.getElementById("inConePackPrice").value="";
        document.getElementById("inBowlPackSize").value="50";
        document.getElementById("inBowlPackPrice").value="";
        document.getElementById("inUnitSize").value="4";
        document.getElementById("inUnitPrice").value="";
        document.getElementById("inTaxPct").value="";
        document.getElementById("inFees").value="";
      };

      // Serving style convenience
      function applyServingStyle(){
        var s = document.getElementById("inServingStyle").value;
        if(s==="cones") document.getElementById("inConePct").value = "80";
        if(s==="bowls") document.getElementById("inConePct").value = "20";
        if(s==="mixed") document.getElementById("inConePct").value = "50";
      }
      document.getElementById("inServingStyle").addEventListener("change", applyServingStyle);
    },

    // Compute: returns state for render
    compute: function(H){
      var $ = H.$, N = H.N;

      var A = N(document.getElementById("inAdults").value,0);
      var T = N(document.getElementById("inTeens").value,0);
      var C = N(document.getElementById("inChildren").value,0);

      // Dessert AE weights
      var AE = A*1.00 + T*0.75 + C*0.50;

      var appetite = N(document.getElementById("inAppetite").value,1.00);
      var role = N(document.getElementById("inRole").value,1.00);

      var scoopEl = document.getElementById("inScoop");
      var scoopCup = (scoopEl.getAttribute("data-math")==="0") ? 1.00 : N(scoopEl.value,0.50);

      var topEl = document.getElementById("inToppings");
      var toppings = (topEl.getAttribute("data-math")==="0")
        ? 1.00
        : (topEl.value==="yes" ? 1.10 : 1.00);

      var scoopsPerAE = 1.00;
      var totalScoops = AE * scoopsPerAE * role * appetite * toppings;

      var cups = totalScoops * scoopCup;

      var pintsRaw = cups / 2;
      var quartsRaw = cups / 4;
      var gallonsRaw = cups / 16;

      var quartsShop = Math.ceil(quartsRaw);
      var frac = quartsRaw - Math.floor(quartsRaw);
      var nearNext = frac >= 0.80;
      if (AE <= 8 && quartsRaw>0) {
        quartsShop = Math.ceil(quartsRaw);
      } else if (nearNext) {
        quartsShop = Math.ceil(quartsRaw);
      }

      var pintsShop = Math.ceil(pintsRaw);
      var gallonsInfo = Math.round(gallonsRaw*100)/100;

      var cupsPerContainer = N(document.getElementById("inUnitSize").value,4);
      var unitPrice = N(document.getElementById("inUnitPrice").value,0);
      var containers = Math.ceil(cups / cupsPerContainer);
      var subContainers = unitPrice>0 ? containers*unitPrice : 0;

      var conePctEl = document.getElementById("inConePct");
      var conePct = (conePctEl.getAttribute("data-math")==="0")
        ? 50
        : Math.max(0, Math.min(100, N(conePctEl.value,50)));
      var guests = A+T+C;
      var conesPeople = Math.ceil(guests * (conePct/100));
      var bowlsPeople = Math.max(0, Math.ceil(guests - conesPeople));

      var conePackSize = Math.max(1, Math.floor(N(document.getElementById("inConePackSize").value,12)));
      var conePackPrice = N(document.getElementById("inConePackPrice").value,0);
      var bowlPackSize = Math.max(1, Math.floor(N(document.getElementById("inBowlPackSize").value,50)));
      var bowlPackPrice = N(document.getElementById("inBowlPackPrice").value,0);

      var conesPacks = Math.ceil(conesPeople / conePackSize);
      var bowlsPacks = Math.ceil(bowlsPeople / bowlPackSize);

      var subCones = conePackPrice>0 ? conesPacks*conePackPrice : 0;
      var subBowls = bowlPackPrice>0 ? bowlsPacks*bowlPackPrice : 0;

      var tax = N(document.getElementById("inTaxPct").value,0)/100;
      var fees = N(document.getElementById("inFees").value,0);
      var subtotal = subContainers + subCones + subBowls;
      var adds = subtotal*tax + (fees>0?fees:0);
      var total = subtotal + adds;
      var ppp = (guests>0 && total>0) ? total/guests : NaN;

      return {
        guests: guests, AE: AE, cups: cups,
        pintsRaw: pintsRaw, quartsRaw: quartsRaw, gallonsRaw: gallonsRaw,
        quartsShop: quartsShop, pintsShop: pintsShop, gallonsInfo: gallonsInfo,
        containers: containers,
        subContainers: subContainers, subCones: subCones, subBowls: subBowls,
        subtotal: subtotal, adds: adds, total: total, ppp: ppp,
        conePct: conePct, conesPacks: conesPacks, bowlsPacks: bowlsPacks
      };
    },

    // Render outputs
    onRender: function(s, H){
      var money = H.money;
      // Buy line (primary unit = quarts)
      document.getElementById("outBuy").textContent = s.guests>0 ? (s.quartsShop>0 ? (String(s.quartsShop) + " quarts of ice cream") : "—") : "—";
      // Also shown
      var alt = [];
      if(s.guests>0){
        alt.push((s.pintsShop>0?String(s.pintsShop):"0")+" pints");
        alt.push((s.containers>0?String(s.containers):"0")+" containers (your size)");
        alt.push((s.gallonsInfo>0?String(s.gallonsInfo):"0")+" gallons (info)");
      }
      document.getElementById("outAltUnits").textContent = s.guests>0 ? alt.join("  |  ") : "—";
      // Guests count
      document.getElementById("outGuests").textContent = s.guests>0 ? String(s.guests) : "—";
      // Pricing outputs
      document.getElementById("outSubContainers").textContent = money(s.subContainers);
      document.getElementById("outSubPacks").textContent      = money(s.subCones + s.subBowls);
      document.getElementById("outSubtotal").textContent      = money(s.subtotal);
      document.getElementById("outAdds").textContent          = s.subtotal>0 ? money(s.adds) : "$—";
      document.getElementById("outTotal").textContent         = s.subtotal>0 ? money(s.total) : "$—";
      document.getElementById("outPPP").textContent           = (s.total>0 && s.guests>0) ? money(s.ppp) : "$—";
    }
  };
</script>
  <script defer src="../../engine/engine.v2.js?v=1.0"></script>
<script defer src="../../engine/engine-utils.js?v=1.0"></script>
<script defer src="../../runner/runner.v2.js?v=1.0"></script>
</body>
</html>
