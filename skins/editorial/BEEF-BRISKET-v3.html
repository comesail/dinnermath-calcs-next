<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Beef Brisket Quantity Calculator - How Much You'll Need</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Compat meta (logic stays on Portion Spec v1.8 + Hybrid cushion) -->
  <meta name="dm-category" content="meat">
  <meta name="dm-food" content="beef brisket">
  <meta name="dm-portion-spec" content="v1.8">
  <meta name="dm-teen-ae" content="0.80">

  <!-- Skins (relative) -->
  <link rel="stylesheet" href="./editorial-v1.1.css">
  <link rel="stylesheet" href="./editorial-premium-v1.0.css">

  <!-- Engine/runner (keep hooks/IDs intact) -->
  <script defer src="../../engine/engine.v2.js"></script>
  <script defer src="../../runner/runner.v2.js"></script>
</head>
<body class="dm-editorial">
  <main id="calculator" class="dm-grid">

    <!-- Header -->
    <section class="card header header--dark" data-section="header">
      <picture class="hero">
        <!-- If your filename differs, swap it (e.g., beef-brisket-slug-hero.jpg) -->
        <img src="./img/beef-brisket-hero.jpg" alt="Sliced beef brisket on a board">
      </picture>
      <h1 class="calc-title dm-h1">Beef Brisket Quantity Calculator - How Much You'll Need</h1>
      <p class="dm-lede">Enter guests and settings (or tap a quick preset). We'll estimate how many pounds of raw brisket you'll need (planning estimate).</p>
    </section>

    <!-- Inputs -->
    <section class="card inputs" data-section="inputs">

      <!-- Guests (not numbered) -->
      <div class="step" id="step-guests">
        <div class="step-label">How many people are you serving?</div>
        <div class="fields three-up">
          <label for="input-adults">Adults</label>
          <input id="input-adults" inputmode="numeric" pattern="[0-9]*" autocomplete="off" value="5" data-hook="adults">
          <label for="input-teens">Teens</label>
          <input id="input-teens" inputmode="numeric" pattern="[0-9]*" autocomplete="off" value="0" data-hook="teens" data-ae="0.80">
          <label for="input-children">Children</label>
          <input id="input-children" inputmode="numeric" pattern="[0-9]*" autocomplete="off" value="0" data-hook="children">
        </div>
        <!-- Per your spec, no teen whisper line displayed here -->
      </div>

      <!-- STEP 1 (Role question only; no "Role/Meal-Share" label) -->
      <div class="step" id="step-role">
        <div class="step-kicker">STEP 1</div>
        <div class="step-label">Will this be the only meat you are serving?</div>
        <div class="select-row">
          <label for="role-select" class="sr-only">Meat role</label>
          <select id="role-select">
            <!-- Dynamic, food-aware copy; multipliers in value for engine bridge -->
            <option value="1.00">This is the only meat being served. Allows for full servings, about 3 to 4 oz cooked per person.</option>
            <option value="0.60">This will be served alongside another meat. Allows for smaller servings, about 2 to 3 oz cooked per person.</option>
            <option value="0.45">I only want to serve a small portion. Allows for a small portion, about 1.5 to 2 oz cooked per person.</option>
            <option value="0.35">This is just a tasting or small bite of beef brisket before the meal. Allows for a tiny portion, about 1 oz cooked per person.</option>
          </select>
        </div>
      </div>

      <!-- STEP 2 (Appetite ladder) -->
      <div class="step" id="step-appetite">
        <div class="step-kicker">STEP 2</div>
        <div class="step-label">How generous would you like portions to be?</div>
        <div class="select-row">
          <label for="appetite-select" class="sr-only">Appetite</label>
          <select id="appetite-select">
            <option value="0.90">Light - Allows for lighter portions.</option>
            <option value="1.00" selected>Typical - Allows for standard portions.</option>
            <option value="1.15">Hearty - Allows for heartier portions.</option>
          </select>
        </div>
      </div>

      <!-- Cut style (un-numbered; food-specific) -->
      <div class="step" id="step-cut-style">
        <div class="step-label">Cut style</div>
        <div class="select-row">
          <label for="cut-style" class="sr-only">Cut style</label>
          <select id="cut-style" data-hook="cut-style">
            <option value="packer" data-cut="packer">Whole packer</option>
            <option value="flat" data-cut="flat">Flat (first cut)</option>
            <option value="point" data-cut="point">Point</option>
          </select>
        </div>
        <div class="whisper">We convert cooked ounces to raw pounds using the shrink for your cut.</div>
      </div>

      <!-- Event Length: hidden for meat per category rules -->
      <!-- Leftovers: removed per Hybrid cushion -->
    </section>

    <!-- Results -->
    <section class="card results" data-section="results">
      <div class="summary">
        <div class="from-line" id="affirm-line">
          Based on your guests, meat role, appetite, and cut style:
        </div>
        <div class="big-number">
          <span id="result-total-raw-lb" data-hook="result-total-raw-lb">0</span>
          <span class="unit">lb raw brisket</span>
        </div>
        <div class="sub-numbers">
          <div><span id="result-total-cooked-oz" data-hook="result-total-cooked-oz">0</span> oz cooked total</div>
          <div><span id="result-per-person-cooked-oz" data-hook="result-per-person-cooked-oz">0</span> oz cooked per person</div>
          <div class="price" id="result-price" data-hook="result-price">$0.00 estimated total</div>
        </div>
        <div class="method-note" id="rounding-note">
          Totals reflect a slight rounding adjustment for realistic portions.
        </div>
      </div>
      <div class="actions">
        <button class="button" data-hook="print">Print results</button>
      </div>
    </section>

    <!-- Pricing (optional) -->
    <section class="card pricing" data-section="pricing">
      <div class="step-label">Pricing (optional)</div>
      <div class="fields three-up">
        <label for="price-per-lb">Unit price ($/lb)</label>
        <input id="price-per-lb" inputmode="decimal" autocomplete="off" value="6.99" data-hook="price-per-lb">
        <label for="sales-tax">Tax %</label>
        <input id="sales-tax" inputmode="decimal" autocomplete="off" value="0" data-hook="price-tax">
        <label for="fees">Fees ($)</label>
        <input id="fees" inputmode="decimal" autocomplete="off" value="0" data-hook="price-fees">
      </div>
      <div class="whisper">Pricing is for planning only.</div>
    </section>

    <!-- Finder -->
    <section class="card finder" data-section="finder">
      <div class="step-label">Finder</div>
      <div class="finder-actions">
        <a class="button primary" data-hook="finder-primary" href="#" rel="noopener">Find brisket near me</a>
        <div class="links">
          <a data-hook="finder-secondary" href="#" rel="noopener">Butcher shops</a>
          <a data-hook="finder-tertiary" href="#" rel="noopener">Grocery stores</a>
        </div>
      </div>
      <div class="whisper">Opens search results in a new tab.</div>
    </section>

    <!-- Legal -->
    <footer class="legal" data-section="legal">
      Planning estimates only. Confirm with your retailer and adjust for your crowd. DinnerMath is not responsible for decisions, purchases, or outcomes based on these estimates. (c) 2025 DinnerMath. All rights reserved.
    </footer>
  </main>

  <!-- UX helpers + dropdown->engine bridge (keeps your existing engine/runner working) -->
  <script>
    (function () {
      // Strong select-all on focus/click
      var ids = ["input-adults","input-teens","input-children","price-per-lb","sales-tax","fees"];
      ids.forEach(function(id){
        var el = document.getElementById(id);
        if(!el) return;
        function sel(){ try { el.select(); } catch(e){} }
        el.addEventListener("focus", sel);
        el.addEventListener("click", sel);
      });

      // Bridge the dropdown UI to the pill-based engine hooks
      function makeHiddenPills(name, values){
        var wrap = document.createElement("div");
        wrap.style.display = "none";
        values.forEach(function(v){
          var b = document.createElement("button");
          b.className = "pill";
          b.setAttribute("data-hook", name);
          b.setAttribute("data-mult", v);
          b.setAttribute("aria-pressed", "false");
          wrap.appendChild(b);
        });
        document.body.appendChild(wrap);
        return wrap.querySelectorAll('[data-hook="'+name+'"]');
      }

      // Appetite ladder
      var appetiteSelect = document.getElementById("appetite-select");
      var appetitePills = makeHiddenPills("appetite", ["0.90","1.00","1.15"]);

      // Role ladder (support both possible hook names used in prior builds)
      var roleSelect = document.getElementById("role-select");
      var rolePillsA = makeHiddenPills("role", ["1.00","0.60","0.45","0.35"]);
      var rolePillsB = makeHiddenPills("meal-share", ["1.00","0.60","0.45","0.35"]);

      function pressMatch(pills, value){
        pills.forEach(function(p){
          var on = p.getAttribute("data-mult") === String(value);
          p.setAttribute("aria-pressed", on ? "true" : "false");
          if(on){ p.dispatchEvent(new Event("click", {bubbles:true})); }
        });
      }

      function syncFromSelects(){
        pressMatch(appetitePills, appetiteSelect.value);
        pressMatch(rolePillsA, roleSelect.value);
        pressMatch(rolePillsB, roleSelect.value);
      }

      appetiteSelect.addEventListener("change", syncFromSelects);
      roleSelect.addEventListener("change", syncFromSelects);

      // Kick once on load so results populate
      window.addEventListener("DOMContentLoaded", function(){
        syncFromSelects();
        ["input-adults","input-teens","input-children"].forEach(function(id){
          var el = document.getElementById(id);
          if(el){ el.dispatchEvent(new Event("input", {bubbles:true})); }
        });
      });
    })();
  </script>
</body>
</html>
